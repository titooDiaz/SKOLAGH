<!DOCTYPE html>
<head>
    <title>Calificaciones del estudiante</title>
</head>

{% extends 'base.html' %}
{% load static %}

{% block content %}


<div>
    <!-- Vista de horario para tables o computadoras!-->
    <div class="hidden lg:block">

        {% include "ui/titles/principal.html" with title="Aqui tienes tus calificaciones!" %}

        <div class="mx-2 lg:mx-20 relative">
            <span class="absolute top-0 left-0 mt-4 ml-4 h-full w-full rounded bg-gray-700"></span>
            <div class="overflow-x-auto shadow-md sm:rounded-lg relative">
                <table class="w-full text-sm text-left rtl:text-right overflow-x-auto text-gray-800">
                    <thead class="text-xs text-white uppercase bg-gray-600">
                        <tr>
                            <th scope="col" class="px-2 py-3">
                                Asignatura.
                            </th>
                            {% for court in courts %}
                                <th scope="col" class="px-2 py-3">
                                    Corte {{court.court_number}}
                                </th>
                            {% endfor %}
                        </tr>
                    </thead>
                    <tbody>
                        {% for subject in subjects %}
                            <tr class="bg-gray-100 border-b hover:bg-gray-200">
                                <td class="px-2 py-2 font-medium">
                                    {% if subject.elective %}
                                        {% if request.user in subject.students_1 %}
                                            {{subject.name_1}}
                                        {% elif request.user in subject.students_2 %}
                                            {{subject.name_2}}
                                        {% else %}
                                            NOOO, {{request.user}}! No estas matriculado en esta materia.
                                        {% endif %}
                                    {% else %}
                                        {{subject.name_1}}
                                    {% endif %}
                                    <br>
                                </td>

                                {% for court_data in subject.courts_data %}
                                    <td class="px-2 py-2">
                                        <!-- Botón modal -->
                                        <button 
                                            onclick="showVentana('information', '{{subject.pk}}-{{court_data.court.pk}}')" 
                                            type="button"
                                            class="SkolaghButton-orange">
                                            View
                                        </button>
                                        
                                        <!-- Modal -->
                                        <div id="information{{subject.pk}}-{{court_data.court.pk}}" class="hidden fixed left-0 top-0 z-50 w-full h-screen bg-[#5858587c]">
                                            <div class="flex items-center justify-center min-h-screen">
                                                <div>
                                                    <!-- Main container for the academic period -->
                                                    <div class="mb-8 bg-white rounded-xl shadow-sm border border-orange-100 overflow-hidden">
                                                        <!-- Header section with period info -->
                                                        <div class="bg-gradient-to-r from-orange-500 to-orange-600 px-6 py-4">
                                                            <button 
                                                                onclick="closeVentana('information', '{{subject.pk}}-{{court_data.court.pk}}')" 
                                                                class="hover:cursor-pointer w-full flex justify-start text-white">
                                                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                                                </svg>
                                                                <h3 class="text-xl font-bold">Corte {{court_data.court.court_number}}</h3>
                                                            </button>
                                                            
                                                            <p class="text-orange-100 text-sm">De {{court_data.court.start_date}} a {{court_data.court.end_date}}</p>
                                                        </div>

                                                        {% if court_data.activities %}
                                                            <!-- Activities table container -->
                                                            <div class="overflow-x-auto">
                                                                <!-- Beautiful activities table -->
                                                                <table class="w-full">
                                                                    <!-- Table header -->
                                                                    <thead class="bg-orange-50 border-b border-orange-200">
                                                                        <tr>
                                                                            <th class="px-6 py-3 text-left text-xs font-semibold text-orange-800 uppercase tracking-wider">
                                                                                Nombre de la actividad
                                                                            </th>
                                                                            <th class="px-6 py-3 text-left text-xs font-semibold text-orange-800 uppercase tracking-wider">
                                                                                Descipcion
                                                                            </th>
                                                                            <th class="px-6 py-3 text-center text-xs font-semibold text-orange-800 uppercase tracking-wider">
                                                                                Porcentaje %
                                                                            </th>
                                                                            <th class="px-6 py-3 text-center text-xs font-semibold text-orange-800 uppercase tracking-wider">
                                                                                Calificacion
                                                                            </th>
                                                                            <th class="px-6 py-3 text-left text-xs font-semibold text-orange-800 uppercase tracking-wider">
                                                                                Nota del Profe
                                                                            </th>
                                                                        </tr>
                                                                    </thead>
                                                                    
                                                                    <!-- Table body with activities -->
                                                                    <tbody class="bg-white divide-y divide-gray-100">
                                                                        {% for act_data in court_data.activities %}
                                                                            <!-- Individual activity row -->
                                                                            <tr class="hover:bg-orange-25 transition-colors duration-150">
                                                                                <!-- Activity name column -->
                                                                                <td class="px-6 py-4">
                                                                                    <div class="flex items-center">
                                                                                        <div class="w-2 h-2 bg-orange-400 rounded-full mr-3"></div>
                                                                                        <span class="text-sm font-medium text-gray-900">{{ act_data.activity.name }}</span>
                                                                                    </div>
                                                                                </td>
                                                                                
                                                                                <!-- Description column -->
                                                                                <td class="px-6 py-4">
                                                                                    <p class="text-sm text-gray-600 leading-relaxed">{{ act_data.activity.description }}</p>
                                                                                </td>
                                                                                
                                                                                <!-- Percentage column -->
                                                                                <td class="px-6 py-4 text-center">
                                                                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800">
                                                                                        {{ act_data.activity.percentage }}%
                                                                                    </span>
                                                                                </td>
                                                                                
                                                                                <!-- Grade column -->
                                                                                <td class="px-6 py-4 text-center">
                                                                                    {% if act_data.nota %}
                                                                                        <!-- Show grade with color coding -->
                                                                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold 
                                                                                            {% if act_data.nota >= 100 %}bg-green-100 text-green-800
                                                                                            {% elif act_data.nota >= 70 %}bg-yellow-100 text-yellow-800
                                                                                            {% else %}bg-red-100 text-red-800{% endif %}">
                                                                                            {{ act_data.nota }}
                                                                                        </span>
                                                                                    {% else %}
                                                                                        <!-- No grade yet -->
                                                                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-500">
                                                                                            Sin calificación
                                                                                        </span>
                                                                                    {% endif %}
                                                                                </td>
                                                                                
                                                                                <!-- Comments column -->
                                                                                <td class="px-6 py-4">
                                                                                    {% if act_data.rating_message %}
                                                                                        <p class="text-xs text-gray-500 italic">{{ act_data.rating_message }}</p>
                                                                                    {% else %}
                                                                                        <span class="text-xs text-gray-400">-</span>
                                                                                    {% endif %}
                                                                                </td>
                                                                            </tr>
                                                                        {% endfor %}
                                                                    </tbody>
                                                                </table>
                                                            </div>

                                                            <!-- Summary section at the bottom -->
                                                            <div class="bg-orange-25 px-6 py-4 border-t border-orange-100">
                                                                <div class="flex justify-between items-center">
                                                                    <!-- Total percentage info -->
                                                                    <div class="flex items-center space-x-4">
                                                                        <div class="flex items-center">
                                                                            <span class="text-sm text-gray-600 mr-2">Total porcentaje:</span>
                                                                            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-orange-100 text-orange-800">
                                                                                {{court_data.total_percentage}}%
                                                                            </span>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <!-- Average grade info -->
                                                                    <div class="flex items-center">
                                                                        <span class="text-sm text-gray-600 mr-2">Promedio del corte:</span>
                                                                        {% if court_data.promedio %}
                                                                            <!-- Show average with color coding -->
                                                                            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-bold 
                                                                                {% if court_data.promedio >= 4.0 %}bg-green-100 text-green-800
                                                                                {% elif court_data.promedio >= 3.0 %}bg-yellow-100 text-yellow-800
                                                                                {% else %}bg-red-100 text-red-800{% endif %}">
                                                                                {{ court_data.promedio|floatformat:2 }}
                                                                            </span>
                                                                        {% else %}
                                                                            <!-- No average yet -->
                                                                            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-500">
                                                                                Sin notas aún
                                                                            </span>
                                                                        {% endif %}
                                                                    </div>
                                                                </div>
                                                            </div>

                                                        {% else %}
                                                            <!-- Empty state when no activities -->
                                                            <div class="px-6 py-12 text-center">
                                                                <div class="w-12 h-12 mx-auto mb-4 bg-orange-100 rounded-full flex items-center justify-center">
                                                                    <svg class="w-6 h-6 text-orange-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                                                                    </svg>
                                                                </div>
                                                                <p class="text-gray-500 text-sm">No hay actividades en este corte</p>
                                                            </div>
                                                        {% endif %}
                                                    </div>
                                                </div> 
                                            </div>
                                        </div>
                                    </td>
                                {% endfor %}
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>


    <!-- Vista de horario para celulares -->
    <!-- View of schedule for phones -->

    <div class="block lg:hidden py-2 px-4 lg:py-2 lg:px-2">
        <div class="block">

        <div id="content_schedule" class="block lg:hidden py-2 px-4 lg:py-2 lg:px-2">
            <!--
                Day one
                Dia uno
            -->
            {% if day == "1" %}
                <div id="monday" class="today_schedule">
            {% else %}
                <div id="monday" class="hidden">
            {% endif %}
                    <div class="mx-auto text-center">
                        <h2 class="lg:py-2 text-4xl tracking-tight font-bold text-gray-900 mb-8 zoom-10">Horario del monday.</h2>
                    </div> 
                    {% for horas in horario %}
                        {% if horas.monday %}
                            <div class="relative mt-8">
                                <span class="absolute top-0 left-0 mt-4 ml-4 h-full w-full rounded bg-gray-700 "></span>
                                <div class="relative items-center bg-gray-300 rounded-lg sm:flex p-4 block shadow-2xl ease-in-out duration-300">
                                    <div class="block w-full">
                                        <h5 class="font-mono font-bold text-gray-900 text-4xl text-center"><i class="fa-solid fa-book"></i> {{horas.monday}}</h5>
                                        <p class="text-center"> <i class="fa-regular fa-clock"></i> | {{horas.hora_inicio}} - {{horas.hora_fin}}</p>
                                        <img class="w-full p-4" src="{{horas.monday.picture1.url }}" alt="Alumno">
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>

            <!--
                Day two
                Dia 2
            -->
            {% if day == "2" %}
                <div id="tuesday" class="today_schedule">
            {% else %}
                <div id="tuesday" class="hidden">
            {% endif %}
                    <div class="mx-auto text-center">
                        <h2 class="lg:py-2 text-4xl tracking-tight font-bold text-gray-900 mb-8 zoom-10">Horario del tuesday.</h2>
                    </div> 
                    {% for horas in horario %}
                        {% if horas.tuesday %}
                            <div class="relative mt-8">
                                <span class="absolute top-0 left-0 mt-4 ml-4 h-full w-full rounded bg-gray-700 "></span>
                                <div class="relative items-center bg-gray-300 rounded-lg sm:flex p-4 block shadow-2xl ease-in-out duration-300">
                                    <div class="block w-full">
                                        <h5 class="font-mono font-bold text-gray-900 text-4xl text-center"><i class="fa-solid fa-book"></i> {{horas.tuesday}}</h5>
                                        <p class="text-center"> <i class="fa-regular fa-clock"></i> | {{horas.hora_inicio}} - {{horas.hora_fin}}</p>
                                        <img class="w-full p-4" src="{{horas.monday.picture1.url }}" alt="Alumno">
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>

            <!--
                Day three
                Dia 3
            -->
            {% if day == "3" %}
                <div id="wednesday" class="today_schedule">
            {% else %}
                <div id="wednesday" class="hidden">
            {% endif %}
                    <div class="mx-auto text-center">
                        <h2 class="lg:py-2 text-4xl tracking-tight font-bold text-gray-900 mb-8 zoom-10">Horario del Miercoles.</h2>
                    </div> 
                    {% for horas in horario %}
                        {% if horas.wednesday %}
                            <div class="relative mt-8">
                                <span class="absolute top-0 left-0 mt-4 ml-4 h-full w-full rounded bg-gray-700 "></span>
                                <div class="relative items-center bg-gray-300 rounded-lg sm:flex p-4 block shadow-2xl ease-in-out duration-300">
                                    <div class="block w-full">
                                        <h5 class="font-mono font-bold text-gray-900 text-4xl text-center"><i class="fa-solid fa-book"></i> {{horas.wednesday}}</h5>
                                        <p class="text-center"> <i class="fa-regular fa-clock"></i> | {{horas.hora_inicio}} - {{horas.hora_fin}}</p>
                                        <img class="w-full p-4" src="{{horas.monday.picture1.url }}" alt="Alumno">
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>

            <!--
                Day four
                Dia 4
            -->
            {% if day == "4" %}
                <div id="thursday" class="today_schedule">
            {% else %}
                <div id="thursday" class="hidden">
            {% endif %}
                    <div class="mx-auto text-center">
                        <h2 class="lg:py-2 text-4xl tracking-tight font-bold text-gray-900 mb-8 zoom-10">Horario del thursday.</h2>
                    </div> 
                    {% for horas in horario %}
                        {% if horas.thursday %}
                            <div class="relative mt-8">
                                <span class="absolute top-0 left-0 mt-4 ml-4 h-full w-full rounded bg-gray-700 "></span>
                                <div class="relative items-center bg-gray-300 rounded-lg sm:flex p-4 block shadow-2xl ease-in-out duration-300">
                                    <div class="block w-full">
                                        <h5 class="font-mono font-bold text-gray-900 text-4xl text-center"><i class="fa-solid fa-book"></i> {{horas.thursday}}</h5>
                                        <p class="text-center"> <i class="fa-regular fa-clock"></i> | {{horas.hora_inicio}} - {{horas.hora_fin}}</p>
                                        <img class="w-full p-4" src="{{horas.monday.picture1.url }}" alt="Alumno">
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>

            <!--
                Day five
                Dia 5
            -->
            {% if day == "5" %}
                <div id="friday" class="today_schedule">
            {% else %}
                <div id="friday" class="hidden">
            {% endif %}
                    <div class="mx-auto text-center">
                        <h2 class="lg:py-2 text-4xl tracking-tight font-bold text-gray-900 mb-8 zoom-10">Horario del friday.</h2>
                    </div> 
                    {% for horas in horario %}
                        {% if horas.friday %}
                            <div class="relative mt-8">
                                <span class="absolute top-0 left-0 mt-4 ml-4 h-full w-full rounded bg-gray-700 "></span>
                                <div class="relative items-center bg-gray-300 rounded-lg sm:flex p-4 block shadow-2xl ease-in-out duration-300">
                                    <div class="block w-full">
                                        <h5 class="font-mono font-bold text-gray-900 text-4xl text-center"><i class="fa-solid fa-book"></i> {{horas.friday}}</h5>
                                        <p class="text-center"> <i class="fa-regular fa-clock"></i> | {{horas.hora_inicio}} - {{horas.hora_fin}}</p>
                                        <img class="w-full p-4" src="{{horas.monday.picture1.url }}" alt="Alumno">
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>

            <!--
                Day six
                Dia 6
            --> 
            {% if day == "6" %}
                <div id="saturday" class="today_schedule">
            {% else %}
                <div id="saturday" class="hidden">
            {% endif %}
                    <div class="mx-auto text-center">
                        <h2 class="lg:py-2 text-4xl tracking-tight font-bold text-gray-900 mb-8 zoom-10">Horario del Sabado.</h2>
                    </div> 
                    <div class="relative mt-8">
                        <span class="absolute top-0 left-0 mt-4 ml-4 h-full w-full rounded bg-gray-700 "></span>
                        <div class="relative items-center bg-gray-300 rounded-lg sm:flex p-4 block shadow-2xl ease-in-out duration-300">
                            <div class="block w-full">
                                <h5 class="font-mono font-bold text-gray-900 text-4xl text-center">No tienes clases! <br> Es sabado!</h5>
                                <img class="w-full p-4" src="{% static 'img/usuarios/alumnos.png' %}" alt="Alumno">
                            </div>
                        </div>
                    </div>
                </div>

            <!--
                Day seven
                Dia 7
            --> 
            {% if day == "7" %}
                <div id="sunday" class="today_schedule">
            {% else %}
                <div id="sunday" class="hidden">
            {% endif %}
                    <div class="mx-auto text-center">
                        <h2 class="lg:py-2 text-4xl tracking-tight font-bold text-gray-900 mb-8 zoom-10">Horario del Domingo.</h2>
                    </div> 
                    <div class="relative mt-8">
                        <span class="absolute top-0 left-0 mt-4 ml-4 h-full w-full rounded bg-gray-700 "></span>
                        <div class="relative items-center bg-gray-300 rounded-lg sm:flex p-4 block shadow-2xl ease-in-out duration-300">
                            <div class="block w-full">
                                <h5 class="font-mono font-bold text-gray-900 text-4xl text-center">No tienes clases! <br> Es Domingo!</h5>
                                <img class="w-full p-4" src="{% static 'img/usuarios/alumnos.png' %}" alt="Alumno">
                            </div>
                        </div>
                    </div>
                </div>
        </div>

        <div class="mx-auto text-center">
            <h2 class="lg:py-2 text-2xl tracking-tight font-bold text-gray-900 my-8 zoom-10">Si quieres ver otro dia puedes usar este menu!</h2>
        </div> 
            <div class="block">
            <div class="flex justify-center mb-4">
                <button onclick="showSection('monday')" type="button" class="myButton font-semibold text-white px-2 rounded-lg bg-orange-600 border-l border-r border-t border-4 border-orange-800 hover:scale-105 transition duration-300 ease-in-out focus:border focus:mt-1 w-full py-2 text-center text-lg">monday</button>
                <div class="mx-2"></div>
                <button onclick="showSection('tuesday')" type="button" class="myButton font-semibold text-white px-2 rounded-lg bg-orange-600 border-l border-r border-t border-4 border-orange-800 hover:scale-105 transition duration-300 ease-in-out focus:border focus:mt-1 w-full py-2 text-center text-lg">tuesday</button>
                <div class="mx-2"></div>
                <button onclick="showSection('wednesday')" type="button" class="myButton font-semibold text-white px-2 rounded-lg bg-orange-600 border-l border-r border-t border-4 border-orange-800 hover:scale-105 transition duration-300 ease-in-out focus:border focus:mt-1 w-full py-2 text-center text-lg">Miercoles</button>
            </div>  
            <div class="flex justify-center mb-4">
                <button onclick="showSection('thursday')" type="button" class="myButton font-semibold text-white px-2 rounded-lg bg-orange-600 border-l border-r border-t border-4 border-orange-800 hover:scale-105 transition duration-300 ease-in-out focus:border focus:mt-1 w-full py-2 text-center text-lg">thursday</button>
                <div class="mx-2"></div>
                <button onclick="showSection('friday')" type="button" class="myButton font-semibold text-white px-2 rounded-lg bg-orange-600 border-l border-r border-t border-4 border-orange-800 hover:scale-105 transition duration-300 ease-in-out focus:border focus:mt-1 w-full py-2 text-center text-lg">friday</button>
            </div>
            <hr>
            <div class="flex justify-center my-4">
                <button onclick="showSection('saturday')" type="button" class="myButton font-semibold text-white px-2 rounded-lg bg-orange-600 border-l border-r border-t border-4 border-orange-800 hover:scale-105 transition duration-300 ease-in-out focus:border focus:mt-1 w-full py-2 text-center text-lg">Sabado</button>
                <div class="mx-2"></div>
                <button onclick="showSection('sunday')" type="button" class="myButton font-semibold text-white px-2 rounded-lg bg-orange-600 border-l border-r border-t border-4 border-orange-800 hover:scale-105 transition duration-300 ease-in-out focus:border focus:mt-1 w-full py-2 text-center text-lg">Domingo</button>
            </div>
        </div>

    </div>
</div>

<script src="{%static 'js/schedule/menu.js'%}"></script>
<script src="{%static 'js/modals/modals_for.js'%}"></script>

{% endblock content %}  
